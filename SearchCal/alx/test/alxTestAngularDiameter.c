/*******************************************************************************
 * JMMC project ( http://www.jmmc.fr ) - Copyright (C) CNRS.
 ******************************************************************************/

/**
 * \file
 * Test program of the function which computes the angular angle of the star. 
 */


/* 
 * System Headers 
 */
#include <stdlib.h>
#include <stdio.h>


/*
 * MCS Headers 
 */
#include "mcs.h"
#include "log.h"
#include "err.h"


/*
 * Local Headers 
 */
#include "alx.h"
#include "alxPrivate.h"


/* 
 * Main
 */
int main (int argc, char *argv[])
{
    /* Configure logging service */
    logSetStdoutLogLevel(logTEST);
    logSetPrintDate(mcsFALSE);
    logSetPrintFileLine(mcsFALSE);

    /* Initializes MCS services */
    if (mcsInit(argv[0]) == mcsFAILURE)
    {
        /* Exit from the application with mcsFAILURE */
        exit (EXIT_FAILURE);
    }


    alxMAGNITUDES mag;
    alxDIAMETERS diameters;

    mag[alxB_BAND].value = 11.190; mag[alxB_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxB_BAND].isSet = mcsTRUE;
    mag[alxV_BAND].value = 10.079; mag[alxV_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxV_BAND].isSet = mcsTRUE;
    mag[alxR_BAND].value = 7.530;  mag[alxR_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxR_BAND].isSet = mcsTRUE;
    mag[alxI_BAND].value = 0.0;    mag[alxI_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxI_BAND].isSet = mcsFALSE;
    mag[alxJ_BAND].value = 0.0;    mag[alxJ_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxJ_BAND].isSet = mcsFALSE;
    mag[alxH_BAND].value = 0.0;    mag[alxH_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxH_BAND].isSet = mcsFALSE;
    mag[alxK_BAND].value = 3.092;  mag[alxK_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxK_BAND].isSet = mcsTRUE;
    mag[alxL_BAND].value = 0.0;    mag[alxL_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxL_BAND].isSet = mcsFALSE;
    mag[alxM_BAND].value = 0.0;    mag[alxM_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxM_BAND].isSet = mcsFALSE;

    if ( alxComputeAngularDiameters("test", mag,diameters) == mcsFAILURE )
    {
        return mcsFAILURE;
    }

    mag[alxB_BAND].value = 2.808;  mag[alxB_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxB_BAND].isSet = mcsTRUE; 
    mag[alxV_BAND].value = 2.870;  mag[alxV_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxV_BAND].isSet = mcsTRUE;
    mag[alxR_BAND].value = 2.840;  mag[alxR_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxR_BAND].isSet = mcsTRUE;
    mag[alxK_BAND].value = 2.636;  mag[alxK_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxK_BAND].isSet = mcsTRUE;

    if ( alxComputeAngularDiameters("test", mag,diameters) == mcsFAILURE )
    {
        return mcsFAILURE;
    }

    alxDIAMETERS diametersFaint;

    mag[alxB_BAND].value = 0.0;    mag[alxB_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxB_BAND].isSet = mcsFALSE;
    mag[alxV_BAND].value = 10.079; mag[alxV_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxV_BAND].isSet = mcsTRUE;
    mag[alxR_BAND].value = 0.0;    mag[alxR_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxR_BAND].isSet = mcsFALSE;
    mag[alxI_BAND].value = 11.094; mag[alxI_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxI_BAND].isSet = mcsTRUE;
    mag[alxJ_BAND].value = 10.418; mag[alxJ_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxJ_BAND].isSet = mcsTRUE;
    mag[alxH_BAND].value = 9.907;  mag[alxH_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxH_BAND].isSet = mcsTRUE;
    mag[alxK_BAND].value = 9.856;  mag[alxK_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxK_BAND].isSet = mcsTRUE;
    mag[alxL_BAND].value = 0.0;    mag[alxL_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxL_BAND].isSet = mcsFALSE;
    mag[alxM_BAND].value = 0.0;    mag[alxM_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxM_BAND].isSet = mcsFALSE;
    
    if ( alxComputeAngularDiameters("test", mag,diametersFaint) == mcsFAILURE )
    {
        return mcsFAILURE;
    }

    mag[alxI_BAND].value = 0.0;    mag[alxI_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxI_BAND].isSet = mcsFALSE;
    mag[alxJ_BAND].value = 0.25;   mag[alxJ_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxJ_BAND].isSet = mcsTRUE;
    mag[alxH_BAND].value = 0.32;   mag[alxH_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxH_BAND].isSet = mcsTRUE;
    mag[alxK_BAND].value = 0.36;   mag[alxK_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxK_BAND].isSet = mcsTRUE;

    if ( alxComputeAngularDiameters("test", mag,diametersFaint) == mcsFAILURE )
    {
        return mcsFAILURE;
    }

    mag[alxI_BAND].value = 0.0;    mag[alxI_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxI_BAND].isSet = mcsFALSE;
    mag[alxJ_BAND].value = 13.658; mag[alxJ_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxJ_BAND].isSet = mcsTRUE;
    mag[alxH_BAND].value = 13.126; mag[alxH_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxH_BAND].isSet = mcsTRUE;
    mag[alxK_BAND].value = 13.069; mag[alxK_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxK_BAND].isSet = mcsTRUE;

    if ( alxComputeAngularDiameters("test", mag,diametersFaint) == mcsFAILURE )
    {
        return mcsFAILURE;
    }

    mag[alxI_BAND].value = 0.0;    mag[alxI_BAND].confIndex = alxNO_CONFIDENCE;   mag[alxI_BAND].isSet = mcsFALSE;
    mag[alxJ_BAND].value = 12.950; mag[alxJ_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxJ_BAND].isSet = mcsTRUE;
    mag[alxH_BAND].value = 12.273; mag[alxH_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxH_BAND].isSet = mcsTRUE;
    mag[alxK_BAND].value = 12.176; mag[alxK_BAND].confIndex = alxCONFIDENCE_HIGH; mag[alxK_BAND].isSet = mcsTRUE;

    if ( alxComputeAngularDiameters("test", mag,diametersFaint) == mcsFAILURE )
    {
        return mcsFAILURE;
    }

    /* test alain chelli's approach (vs IDL) */
    
    /* V-K results */
    /* I M1 EM1 M2 EM2 DIAM1 EDIAM1 DIAMC1 EDIAMC1 */
    mcsDOUBLE DATA[129][9] = {
      {       0,       6.1700000,    0.0050000000,       4.5360000,     0.031000000,     0.567000,   0.00800000,      0.54422936,     0.010431159},
      {       1,       5.8600000,    0.0030000000,       4.4580000,     0.030000000,     0.569000,    0.0110000,      0.54422307,     0.010177275},
      {       2,       5.7400000,    0.0030000000,       3.6100001,      0.10000000,     0.868000,   0.00400000,      0.89721520,     0.054245144},
      {       3,       3.4900000,    0.0020000000,      0.27399999,     0.021000000,      4.75900,    0.0480000,       4.8204311,     0.060740843},
      {       4,       6.4200000,    0.0050000000,       4.4910000,     0.030000000,     0.607000,    0.0150000,      0.58076606,     0.010684171},
      {       5,       4.1300000,    0.0030000000,       2.9000001,      0.10000000,      1.08200,   0.00900000,       1.0852482,     0.067432612},
      {       6,       4.0400000,    0.0020000000,       2.8199999,      0.10000000,      1.11000,   0.00700000,       1.1241726,     0.069871802},
      {       7,       4.8200000,    0.0020000000,       3.6440000,      0.23200000,     0.794000,    0.0140000,      0.76376630,      0.11018579},
      {       8,       5.3700000,    0.0040000000,       3.8210000,     0.046000000,     0.771000,    0.0120000,      0.74664595,     0.021195088},
      {       9,       3.4600000,    0.0020000000,       1.1900001,     0.020000000,      2.76400,    0.0300000,       2.7896378,     0.034283690},
      {      10,       3.3900000,    0.0030000000,      -1.2399998,     0.060000000,      10.7090,     0.107000,       11.316858,      0.38271435},
      {      11,       6.6000000,    0.0040000000,       3.1500001,      0.10000000,      1.17500,    0.0400000,       1.3189237,     0.076562472},
      {      12,       4.7800000,    0.0030000000,       4.0200000,      0.32400000,     0.731000,    0.0300000,      0.59971420,      0.12232131},
      {      13,       3.0600000,    0.0040000000,     -0.86000013,     0.050000000,      8.53800,    0.0850000,       8.8240124,      0.25362165},
      {      14,       3.0000000,    0.0030000000,      0.42399999,     0.015000000,      4.12000,    0.0410000,       4.1410420,     0.038655035},
      {      15,       2.8500000,    0.0020000000,      0.79999995,     0.010000000,      3.28300,    0.0330000,       3.2350618,     0.021066081},
      {      16,       4.0400000,    0.0040000000,     0.069999933,     0.030000000,      6.11600,     0.115000,       5.7817078,      0.10077566},
      {      17,       3.4900000,    0.0020000000,       1.3399999,     0.010000000,      2.47700,    0.0650000,       2.5594237,     0.016671165},
      {      18,       3.5900000,    0.0040000000,       2.3299999,     0.020000000,      1.43100,   0.00600000,       1.4177925,     0.018027864},
      {      19,       4.0500000,    0.0030000000,       2.6389999,     0.014400000,      1.24800,   0.00800000,       1.2594774,     0.011643970},
      {      20,       3.3300000,    0.0030000000,       3.3000000,      0.10000000,     0.740000,    0.0240000,      0.73496806,     0.047588696},
      {      21,       4.2400000,    0.0020000000,       2.8299999,     0.020000000,      1.21200,    0.0300000,       1.1532468,     0.014532194},
      {      22,       4.2300000,    0.0030000000,       2.8729999,     0.013600000,      1.12700,    0.0110000,       1.1212441,    0.0098727544},
      {      23,       4.4700000,    0.0020000000,       3.4799998,     0.080000000,     0.841000,    0.0130000,      0.79909942,     0.040056395},
      {      24,       4.9700000,    0.0030000000,       3.2500000,     0.020000000,      1.00900,    0.0240000,      0.99691227,     0.012416896},
      {      25,       4.4900000,    0.0030000000,       3.9879999,     0.024800000,     0.581000,    0.0120000,      0.58231152,    0.0096575943},
      {      26,       4.4200000,    0.0030000000,       4.3150000,     0.046000000,     0.430000,    0.0170000,      0.46685879,     0.014190761},
      {      27,       7.4900000,    0.0090000000,       3.3100000,     0.060000000,      1.46400,    0.0300000,       1.3300728,     0.045466481},
      {      28,       6.4800000,    0.0050000000,       3.8050000,      0.25000000,     0.769000,    0.0670000,      0.88448290,      0.13137607},
      {      29,       8.4600000,     0.017000000,       4.4500000,     0.040000000,     0.835000,    0.0140000,      0.77259824,     0.017846350},
      {      30,       4.6896080,    0.0020000000,       2.2369545,      0.25000000,      1.89000,    0.0200000,       1.7668820,      0.26425020},
      {      31,       5.1694053,    0.0080000000,       3.3499308,     0.020000000,     0.973000,   0.00900000,      0.96640890,     0.012049855},
      {      32,       5.6291617,    0.0020000000,       3.8399028,      0.10000000,     0.763000,    0.0210000,      0.76772118,     0.046894419},
      {      33,       5.3986555,    0.0030000000,       3.6998437,      0.10000000,     0.821000,    0.0130000,      0.80778456,     0.049477302},
      {      34,       4.3884345,    0.0030000000,       2.9798182,     0.030000000,      1.05100,   0.00900000,       1.0761290,     0.020119103},
      {      35,       3.5181048,    0.0030000000,       1.4297800,     0.020000000,      2.39400,    0.0290000,       2.4340810,     0.030036115},
      {      36,       7.6378757,     0.016000000,       4.0897535,     0.011000000,     0.871000,    0.0150000,      0.86558598,    0.0062942631},
      {      37,       7.6976686,     0.012000000,       4.1497294,     0.011000000,     0.856000,    0.0160000,      0.84198761,    0.0060326451},
      {      38,       5.5671794,    0.0080000000,       3.2496724,     0.020000000,      1.10600,   0.00700000,       1.0877104,     0.013406982},
      {      39,       5.0669050,    0.0030000000,       3.7476406,      0.24600000,     0.788000,    0.0260000,      0.74503964,      0.11347954},
      {      40,       4.8368509,    0.0030000000,       3.2796345,     0.040000000,     0.936000,    0.0250000,      0.95926403,     0.023697554},
      {      41,       5.2367304,    0.0090000000,       3.2496201,     0.050000000,      1.00000,   0.00400000,       1.0374826,     0.031597439},
      {      42,       9.1464989,     0.029000000,       4.5695931,      0.10000000,     0.859000,    0.0140000,      0.77544265,     0.043544804},
      {      43,       8.6762509,     0.018000000,       4.5795645,     0.011000000,     0.744000,   0.00400000,      0.73469856,    0.0054508188},
      {      44,       8.0857855,     0.020000000,       4.0095108,     0.011000000,      1.00000,    0.0500000,      0.95316349,    0.0071187618},
      {      45,       5.7156358,    0.0050000000,       3.0994931,     0.070000000,      1.17700,    0.0300000,       1.2144065,     0.050701395},
      {      46,       5.8754816,    0.0090000000,       3.9694755,     0.010000000,     0.790000,    0.0270000,      0.73592430,    0.0048891480},
      {      47,       5.0354682,    0.0030000000,       4.0074737,      0.29400000,     0.785000,    0.0240000,      0.63069112,      0.11580512},
      {      48,       3.3447918,    0.0020000000,       2.2993951,      0.10000000,      1.40100,   0.00900000,       1.3888973,     0.086800922},
      {      49,       5.1646026,    0.0020000000,       3.5293729,      0.10000000,     0.845000,    0.0250000,      0.86534432,     0.053104150},
      {      50,       4.2844192,    0.0020000000,       2.9093518,     0.020000000,      1.08100,    0.0140000,       1.1057758,     0.013958085},
      {      51,       5.8543364,    0.0050000000,       4.2963423,     0.046000000,     0.597000,    0.0150000,      0.60068760,     0.017049144},
      {      52,       2.9639090,    0.0030000000,       1.1492926,     0.010000000,      2.57500,    0.0780000,       2.6605624,     0.017382001},
      {      53,       4.6638010,    0.0070000000,       2.7792803,     0.010000000,      1.25400,    0.0120000,       1.2690888,    0.0083667552},
      {      54,       5.9531066,    0.0050000000,       4.0691992,      0.10000000,     0.854000,    0.0240000,      0.70059784,     0.042675071},
      {      55,       4.1926850,    0.0030000000,       2.9191506,     0.010000000,      1.09100,   0.00800000,       1.0832288,    0.0073434446},
      {      56,       6.7018227,    0.0080000000,       5.3450504,     0.030000000,     0.346000,   0.00700000,      0.35914882,    0.0067413383},
      {      57,       3.1816108,    0.0030000000,       2.0790257,     0.030000000,      1.52400,   0.00400000,       1.5516519,     0.029402550},
      {      58,       5.5716106,    0.0030000000,       4.3050257,     0.046000000,     0.542000,    0.0160000,      0.57156270,     0.016377924},
      {      59,       3.7015380,    0.0020000000,       3.4240173,      0.27600000,     0.768000,    0.0170000,      0.72580809,      0.12794925},
      {      60,       4.6112967,    0.0030000000,       3.6379893,      0.24800000,     0.775000,    0.0270000,      0.74098311,      0.11496440},
      {      61,       5.7710759,    0.0040000000,       4.7139637,     0.031000000,     0.445000,    0.0120000,      0.45770777,    0.0089772949},
      {      62,       6.4307952,    0.0050000000,       4.5139311,     0.028000000,     0.573000,    0.0100000,      0.57363829,    0.0098655913},
      {      63,       8.5404017,     0.015000000,       4.6168854,     0.034000000,     0.722000,   0.00800000,      0.70869233,     0.014001611},
      {      64,       6.0600331,    0.0040000000,       4.3128426,     0.052000000,     0.624000,   0.00900000,      0.61357879,     0.019554132},
      {      65,       2.9800245,    0.0030000000,       2.9088416,     0.020000000,     0.895000,    0.0170000,      0.88665530,     0.013179625},
      {      66,       5.4396800,    0.0030000000,       3.9788016,     0.020000000,     0.696000,    0.0110000,      0.68488530,    0.0086132847},
      {      67,       5.7187090,    0.0030000000,       4.0746888,     0.037000000,     0.698000,    0.0190000,      0.67407540,     0.015372875},
      {      68,       5.7883430,    0.0040000000,       4.3866463,     0.037000000,     0.584000,    0.0100000,      0.56237630,     0.012931591},
      {      69,       3.7582830,    0.0040000000,       2.6686394,     0.020000000,      1.20600,    0.0530000,       1.1802046,     0.015181822},
      {      70,       6.2568140,    0.0050000000,       4.5794686,     0.030000000,     0.547000,    0.0130000,      0.53697733,    0.0099518680},
      {      71,       3.4663620,    0.0020000000,       1.3484161,      0.10000000,      2.62400,    0.0340000,       2.5378223,      0.15348899},
      {      72,       2.5255660,    0.0040000000,      -1.6716760,     0.070000000,      13.2380,     0.256000,       13.212991,      0.52571619},
      {      73,       3.1255370,    0.0040000000,     -0.64167944,     0.040000000,      7.53800,    0.0750000,       7.8446675,      0.18176602},
      {      74,       5.1154030,    0.0030000000,       3.8663049,      0.25600000,     0.706000,    0.0130000,      0.69758216,      0.11080179},
      {      75,       2.9548940,    0.0040000000,     -0.93175407,     0.040000000,      9.33200,     0.173000,       9.0868109,      0.20988860},
      {      76,       5.9444640,    0.0050000000,       4.5571958,     0.048000000,     0.530000,    0.0150000,      0.51871918,     0.015443527},
      {      77,       3.8043650,    0.0030000000,     -0.12181580,      0.10000000,      6.43000,    0.0690000,       6.2852965,      0.35944314},
      {      78,       5.8132110,    0.0030000000,       4.4430503,     0.030000000,     0.520000,   0.00600000,      0.54524488,     0.010209058},
      {      79,       4.5523430,    0.0030000000,       3.4999495,      0.37200000,     0.949000,    0.0260000,      0.79993776,      0.18570398},
      {      80,       4.6121160,     0.013000000,      -1.0020769,     0.070000000,      10.5880,     0.170000,       11.063608,      0.43088150},
      {      81,       3.6914460,    0.0020000000,       1.6578454,     0.030000000,      2.18000,    0.0900000,       2.1740989,     0.039856147},
      {      82,       5.9513700,    0.0060000000,       4.4478363,      0.10000000,     0.572000,   0.00900000,      0.55551048,     0.034230540},
      {      83,       3.3908920,    0.0020000000,       1.2377810,     0.030000000,      2.65000,    0.0400000,       2.6839809,     0.049048732},
      {      84,       2.4607480,    0.0020000000,     0.077764282,     0.017100000,      4.61200,    0.0460000,       4.7300105,     0.049990101},
      {      85,       4.9703020,    0.0020000000,       3.9417125,      0.32000000,     0.713000,   0.00900000,      0.65014664,      0.12992884},
      {      86,       6.5500220,    0.0050000000,       5.5106800,     0.036000000,     0.340000,    0.0100000,      0.31621524,    0.0071842932},
      {      87,       5.6380280,    0.0030000000,       3.9964484,     0.046000000,     0.712000,    0.0310000,      0.69854572,     0.019770094},
      {      88,       5.9464870,    0.0060000000,       5.2372695,     0.028000000,     0.342000,   0.00800000,      0.33943423,    0.0061801724},
      {      89,       3.2464250,    0.0030000000,      0.42726232,     0.040000000,      4.13600,    0.0410000,       4.2708365,      0.10172704},
      {      90,       3.4848610,    0.0020000000,       1.3670808,     0.040000000,      2.49600,    0.0400000,       2.5160423,     0.061125969},
      {      91,       4.8038220,     0.022000000,      -2.0530397,     0.070000000,      19.0860,     0.191000,       19.528336,      0.79626154},
      {      92,       4.1637610,    0.0010000000,       3.0569528,     0.010000000,      1.00000,   0.00600000,      0.98970764,    0.0068723305},
      {      93,       5.9628080,    0.0040000000,       4.4278425,     0.012900000,     0.554000,    0.0110000,      0.56338453,    0.0046786767},
      {      94,       6.2226320,    0.0040000000,       4.6598219,     0.012000000,     0.513000,    0.0120000,      0.50848137,    0.0039486793},
      {      95,       7.5104220,    0.0070000000,       5.6665651,     0.031000000,     0.332000,   0.00600000,      0.33374346,    0.0063608525},
      {      96,       3.0399590,    0.0020000000,      0.79651132,      0.10000000,      3.25400,    0.0530000,       3.3313240,      0.20071845},
      {      97,       4.4964990,    0.0010000000,       3.7661095,     0.010000000,     0.648000,   0.00800000,      0.67072923,    0.0051067349},
      {      98,       3.5404780,    0.0020000000,       3.5304103,      0.27200000,     0.835000,    0.0130000,      0.65857652,      0.11534050},
      {      99,       7.4897130,    0.0070000000,       6.2783215,     0.028000000,     0.231000,   0.00600000,      0.22833304,    0.0040307655},
      {     100,       2.9077940,    0.0040000000,      0.93509871,     0.040000000,      3.23700,    0.0570000,       3.0058611,     0.073342229},
      {     101,       1.9466360,    0.0040000000,      -1.2150359,     0.020000000,      9.72700,    0.0970000,       9.5053189,      0.11460420},
      {     102,       4.6946330,    0.0020000000,      0.21473184,     0.070000000,      5.64000,     0.145000,       5.7060931,      0.22532778},
      {     103,       3.7219840,    0.0020000000,       1.5844239,     0.040000000,      2.33800,    0.0330000,       2.2828800,     0.055430616},
      {     104,       3.4818520,    0.0020000000,       1.3144086,     0.010000000,      2.67100,    0.0320000,       2.5962358,     0.016912438},
      {     105,       7.1505300,    0.0070000000,       5.8232551,     0.033000000,     0.289000,   0.00600000,      0.28681892,    0.0059142888},
      {     106,       2.0194160,    0.0040000000,      -1.8758744,     0.080000000,      13.7490,     0.137000,       14.049227,      0.64397499},
      {     107,       3.1536540,    0.0010000000,       1.0734565,     0.020000000,      2.82100,    0.0280000,       2.8647713,     0.035337533},
      {     108,       3.0976680,    0.0020000000,     -0.22723858,      0.10000000,      5.27500,    0.0670000,       6.1535897,      0.35860904},
      {     109,       2.6202090,    0.0030000000,     -0.63810464,     0.020000000,      7.50000,    0.0750000,       7.3751291,     0.088675595},
      {     110,       6.9385630,    0.0070000000,       5.0197041,     0.026000000,     0.436000,   0.00500000,      0.45458102,    0.0072782303},
      {     111,       2.6383310,    0.0020000000,     -0.64948413,     0.012900000,      7.27100,    0.0730000,       7.4407152,     0.059973231},
      {     112,       3.4454330,    0.0030000000,      0.13017918,     0.030000000,      5.23800,    0.0690000,       5.2135699,     0.092333282},
      {     113,       3.6251310,    0.0030000000,    -0.081016979,     0.020000000,      5.78700,    0.0580000,       6.0175665,     0.071668155},
      {     114,       3.2919770,    0.0020000000,     0.098616578,     0.010000000,      5.23400,    0.0520000,       5.2112987,     0.033963828},
      {     115,       4.6611460,    0.0020000000,       1.7785199,      0.10000000,      2.33800,    0.0510000,       2.3112762,      0.13656446},
      {     116,       3.2173100,    0.0090000000,      -1.9319251,     0.010000000,      16.5550,     0.166000,       16.330436,      0.14418398},
      {     117,       4.4025700,    0.0030000000,      0.65236297,      0.19200000,      4.52100,    0.0470000,       4.3144712,      0.47582960},
      {     118,       4.3182600,    0.0020000000,      0.50586219,     0.030000000,      4.45800,    0.0450000,       4.6481716,     0.081253423},
      {     119,       4.4332900,    0.0050000000,      0.70528556,     0.080000000,      4.05600,    0.0410000,       4.1999594,      0.19351194},
      {     120,       2.9254700,    0.0020000000,      0.15437724,     0.040000000,      4.70300,    0.0470000,       4.8122583,      0.11477440},
      {     121,       3.7117100,    0.0020000000,      0.99277945,     0.020000000,      3.17000,    0.0320000,       3.2484272,     0.039553984},
      {     122,       3.6117600,    0.0030000000,     0.091623636,     0.030000000,      5.38100,    0.0550000,       5.4388393,     0.095777508},
      {     123,       4.6723000,    0.0030000000,       1.3095252,      0.21000000,      2.90700,    0.0480000,       3.0462706,      0.37199669},
      {     124,       4.2806400,    0.0030000000,       1.3200098,      0.29400000,      2.78100,    0.0560000,       2.8835180,      0.49918966},
      {     125,       3.0373900,    0.0020000000,       3.1753099,     0.030000000,     0.753000,   0.00900000,      0.75473584,     0.016040986},
      {     126,       3.9954800,    0.0070000000,      -1.2460731,     0.050000000,      11.5300,     0.156000,       12.003685,      0.33974835},
      {     127,       4.0348200,    0.0050000000,     -0.90079498,     0.060000000,      9.55800,    0.0960000,       9.9641533,      0.33544564},
      {     128,       1.9031500,    0.0030000000,      0.68204325,     0.020000000,      3.01700,    0.0300000,       3.0095490,     0.038338689}
    };
    
    /* Compute diameters for band V-K */
    logSetStdoutLogLevel(logINFO);

    int i;

    /* reset magnitudes */
    for (i = 0; i < alxNB_BANDS; i++)
    {
        mag[i].isSet = mcsFALSE;
    }

    const mcsDOUBLE errCorr = 0.033237860;
    mcsDOUBLE err;
    
    mcsDOUBLE deltaDiam, deltaErr;
    
    for (i = 0; i < 129; i++)
    {
      /* I M1 EM1 M2 EM2 DIAM1 EDIAM1 DIAMC1 EDIAMC1 */
      mag[alxV_BAND].isSet = mcsTRUE;
      mag[alxV_BAND].value = DATA[i][1];
      mag[alxV_BAND].error = DATA[i][2];
      
      mag[alxK_BAND].isSet = mcsTRUE;
      mag[alxK_BAND].value = DATA[i][3];
      mag[alxK_BAND].error = DATA[i][4];
      
      if ( alxComputeAngularDiameters("test", mag, diameters) == mcsSUCCESS )
      {
	/* correct errors */
	err = DATA[i][8] / DATA[i][7];
	err = DATA[i][7] * sqrt(err * err + errCorr * errCorr);
	
	/* compute delat */
	deltaDiam = fabs(diameters[alxV_K_DIAM].value - DATA[i][7]);
	deltaErr  = fabs(diameters[alxV_K_DIAM].error - err);
	
	if (deltaDiam > 1e-3 || deltaErr  > 1e-3)
	{
	  logError("Diameter[%d] = %.3lf(%.3lf %.1lf%%) [%.3lf(%.3lf %.1lf%%)] for magA=%.3lf(%.3lf) magB=%.3lf(%.3lf)",
		   i, 
		   diameters[alxV_K_DIAM].value, diameters[alxV_K_DIAM].error, alxDATARelError(diameters[alxV_K_DIAM]),
		   DATA[i][7], err, 100.0 * err / DATA[i][7],
	    mag[alxV_BAND].value, mag[alxV_BAND].error, mag[alxK_BAND].value, mag[alxK_BAND].error
	  );
	}
	else
	{
	  logInfo("Diameter[%d] = %.3lf(%.3lf %.1lf%%) [%.3lf(%.3lf %.1lf%%)] for magA=%.3lf(%.3lf) magB=%.3lf(%.3lf)",
		  i, 
		  diameters[alxV_K_DIAM].value, diameters[alxV_K_DIAM].error, alxDATARelError(diameters[alxV_K_DIAM]),
		  DATA[i][7], err, 100.0 * err / DATA[i][7],
	   mag[alxV_BAND].value, mag[alxV_BAND].error, mag[alxK_BAND].value, mag[alxK_BAND].error
	  );
	}
      }
    }

    /* Close MCS services */
    mcsExit();
    
    /* Exit from the application with SUCCESS */
    exit (EXIT_SUCCESS);
}


/*___oOo___*/
